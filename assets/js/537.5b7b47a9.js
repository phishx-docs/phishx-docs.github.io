(window.webpackJsonp=window.webpackJsonp||[]).push([[537],{862:function(s,t,a){"use strict";a.r(t);var n=a(13),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"protecao-do-exchange-online"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#protecao-do-exchange-online"}},[s._v("#")]),s._v(" Proteção do Exchange Online")]),s._v(" "),t("h2",{attrs:{id:"resumo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#resumo"}},[s._v("#")]),s._v(" Resumo")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("Configurar")]),s._v(" e "),t("strong",[s._v("implantar")]),s._v(" os domínios permitidos em suas caixas postais online.")])]),s._v(" "),t("h2",{attrs:{id:"configuracoes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuracoes"}},[s._v("#")]),s._v(" Configurações")]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("Converse com seu time interno")]),s._v(" e "),t("strong",[s._v("escolha a melhor maneira")]),s._v(" de configurar sua "),t("strong",[s._v("Lista de Remetentes Confiáveis")]),s._v(" no EOP.")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.microsoft.com/pt-br/microsoft-365/security/office-365-security/create-safe-sender-lists-in-office-365?view=o365-worldwide",target:"_blank",rel:"noopener noreferrer"}},[s._v("Criar listas de remetentes seguros no EOP"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.microsoft.com/pt-br/microsoft-365/security/office-365-security/configure-junk-email-settings-on-exo-mailboxes?view=o365-worldwide",target:"_blank",rel:"noopener noreferrer"}},[s._v("Definir as configurações de lixo eletrônico nas caixas de correio do Exchange Online"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("OBS: Temos um script exemplo que pode ajudar. "),t("a",{attrs:{href:"https://cdn.phishx.io/test/safesenders.txt",target:"_blank",rel:"noopener noreferrer"}},[s._v("Script"),t("OutboundLink")],1),s._v(".")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Instale")]),s._v(" os requisitos para executar os comandos via "),t("strong",[s._v("Powershell")]),s._v(".")]),s._v(" "),t("p",[s._v("OBS: Powershell precisa ser atualizado.")])])]),s._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Install-Module")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Name ExchangeOnlineManagement "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Scope CurrentUser "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Force "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("AllowClobber "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("AcceptLicense\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[t("strong",[s._v("Conecte")]),s._v(" ao Exchange Online.")]),s._v(" "),t("p",[s._v("Utilize um usuário administrativo.")])])]),s._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Set-ExecutionPolicy")]),s._v(" RemoteSigned\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Import-Module")]),s._v(" ExchangeOnlineManagement\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userAdmin")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"USER-ADMIN@DOMAIN"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Connect-ExchangeOnline")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("UserPrincipalName "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userAdmin")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Get-ConnectionInformation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UserPrincipalName\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[t("strong",[s._v("Filtre")]),s._v(" os usuários de acordo com o escopo e onda de distribuição.")]),s._v(" "),t("p",[s._v("Para aplicar em todos os usuários.")])])]),s._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$All")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Get-Mailbox")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("RecipientTypeDetails UserMailbox "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ResultSize Unlimited\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQty")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$All")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Measure-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Select-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ExpandProperty Count\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQtyDigits")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ToString"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Length\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQty")]),s._v("\n")])])]),t("p",[s._v("Para aplicar apenas em um grupo de usuários.")]),s._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$All")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Get-UnifiedGroupLinks")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Identity "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<GROUP>'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("LinkType Members "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ResultSize Unlimited\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQty")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$All")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Measure-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Select-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ExpandProperty Count\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQtyDigits")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ToString"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Length\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQty")]),s._v("\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[t("p",[t("strong",[s._v("Configure")]),s._v(" os domínios que os usuários devem confiar em sua "),t("strong",[s._v("Lista de Remetentes Confiáveis")]),s._v(".")]),s._v(" "),t("p",[s._v("Defina os "),t("strong",[s._v("domínios")]),s._v(" que serão utilizados. "),t("RouterLink",{attrs:{to:"/pt/guide/requirements/domains.html#separada-por-espacos"}},[s._v("Domínios")])],1),s._v(" "),t("p",[s._v("Opcionalmente, adicione outros domínios de terceiros para serem confiados via Lista de Remetentes Confiáveis.")])])]),s._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$safeDomains")]),s._v(" = @"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"appcentral.info"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"appstudio.shop"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"businessuniversity.tech"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cloudacademy.live"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cloudconnect.cfd"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dealsnews.club"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deviceguard.pro"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"digitaleducation.digital"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"festivalnews.online"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"infoportal.live"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linkdata.live"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mailvault.site"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"marketonline.one"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"microlearning.academy"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"peoplex.io"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"phishing.com.br"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"phishx.com"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"phishx.com.br"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"phishx.io"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"privacynow.click"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proopportunity.one"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"securedevice.site"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"securetech.lat"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"securityapp.cloud"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"smartdevice.live"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"technews.rest"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"trainingportal.me"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"varejoonline.club"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webportal.one"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$safeDomainsQty")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$safeDomains")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Measure-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Select-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ExpandProperty Count\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$safeDomainsQty")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorLogFile")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".\\JunkEmailConfigErrors.txt"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Clear-Content")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Path "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorLogFile")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ErrorAction SilentlyContinue\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$index")]),s._v(" = 0\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$All")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ForEach-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$index")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$indexPadded")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$index")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ToString"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PadLeft"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$AllQtyDigits")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mailbox")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mailboxName")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mailbox")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mailboxAlias")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mailbox")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Alias\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userDomains")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mailbox")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EmailAddresses "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ForEach-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$emailAddress")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ToString"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Split"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("':'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$emailAddress")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Split"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Where-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-notlike")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SPO_*"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Sort-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Unique\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filteredSafeDomains")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$safeDomains")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Where-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userDomains")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-notcontains")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filteredSafeDomainsQty")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filteredSafeDomains")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Measure-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Select-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ExpandProperty Count\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Set-MailboxJunkEmailConfiguration")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mailboxName")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("TrustedSendersAndDomains @"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Add="),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$filteredSafeDomains")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ErrorAction Stop\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Write-Host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${indexPadded} / ${AllQty}: Successfully updated with ${filteredSafeDomainsQty} domains in junk email configuration for ${mailboxAlias}."')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorMessage")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${indexPadded} / ${AllQty}: Error processing '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mailboxAlias")]),s._v(" (Domain: "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userDomains")]),s._v("): "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Exception"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])]),s._v('"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Write-Host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorMessage")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ForegroundColor Red\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorMessage")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Out-File")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("FilePath "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorLogFile")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Append\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorsQty")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Get-Content")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorLogFile")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Measure-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Select-Object")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ExpandProperty Count\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Write-Host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"Script finished (${AllQty}). Check '"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$errorLogFile")]),s._v("' for any errors (${errorsQty}).\"")]),s._v("\n")])])]),t("ol",{attrs:{start:"5"}},[t("li",[t("p",[t("strong",[s._v("Valide")]),s._v(" os domínios de um usuário.")]),s._v(" "),t("p",[s._v("Utilize um usuário que recebeu as novas configurações.")])])]),s._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userTest")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"USER-TEST@DOMAIN"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userDomain")]),s._v(" = "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userTest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Split"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Set-MailboxJunkEmailConfiguration")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Identity "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userTest")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("TrustedSendersAndDomains @"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Add="),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userDomain")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Get-MailboxJunkEmailConfiguration")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Identity "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$userTest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TrustedSendersAndDomains "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ConvertTo-Json")]),s._v("\n")])])]),t("p",[s._v("Opcionalmente confirme no Outlook do usuário.")]),s._v(" "),t("p",[s._v("Acessar no Outlook Novo "),t("strong",[s._v("Configurações")]),s._v(" -> "),t("strong",[s._v("E-mail")]),s._v(" -> "),t("strong",[s._v("Lixo eletrônico")]),s._v(" -> "),t("strong",[s._v("Remetentes")]),s._v(" -> "),t("strong",[s._v("Domínios e remetentes")]),s._v(".")]),s._v(" "),t("p",[s._v("Acessar no Outlook Clássico "),t("strong",[s._v("Página Inicial")]),s._v(" -> "),t("strong",[s._v("Exlcuir")]),s._v(" -> "),t("strong",[s._v("Lixo Eletrônico")]),s._v(" -> "),t("strong",[s._v("Opções de Lixo Eletrônico")]),s._v(" -> "),t("strong",[s._v("Remetentes Confiáveis")]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.phishx.io/phishx-docs/images/phishx_settings_docs_safe_senders_list_03.jpg",alt:"Microsoft Outlook"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);